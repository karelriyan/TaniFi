# Scenario 3: DiLoCo + QLoRA
# DiLoCo: rare sync, long local training per round
# 10 farmers, 20 rounds, 500 local steps = 10,000 total steps/farmer

dataset:
  name: combined
  image_size: 224
  train_split: 0.8
  val_split: 0.1
  test_split: 0.1

device:
  use_gpu: true
  gpu_id: 0
  num_workers: 8

model:
  name: YOLOv11ClassificationModel
  num_classes: 41
  lora_rank: 4

adapter_type: qlora
adapter_config:
  r: 4
  lora_alpha: 32
  target_modules: ["classifier.2"]
  lora_dropout: 0.05

federated:
  num_farmers: 10
  num_rounds: 20
  local_steps: 500      # Long local run â†’ rare sync (DiLoCo-style)
  non_iid: true
  aggregation_method: fedavg
  min_samples_per_farmer: 10
  max_samples_per_farmer: 150
  warmup_rounds: 5

training:
  batch_size: 64
  learning_rate: 0.001
  optimizer: adamw
  weight_decay: 0.0001
  use_scheduler: true
  scheduler_type: cosine

simulation:
  simulate_network_delay: false
  simulate_memory_constraint: false
  simulate_intermittent_connectivity: false

experiment:
  name: diloco_qlora_combined
  description: "DiLoCo federated learning with QLoRA adapter on combined WeedsGalore+PlantVillage (rare sync, long local steps)"
  tags: [diloco, qlora, federated, combined, weedsgalore, plantvillage]
